import React, { useState } from "react";
import axios from 'axios';
import { useNavigate, Link } from 'react-router-dom';
import Logo from '../images/LMW_logo.png'

const RegForm = (props) => {

    const navigate = useNavigate()

    const [nombre, setNombre] = useState('')
    const [apellido, setApellido] = useState('')
    const [iglesia, setIglesia] = useState('')
    const [edad, setEdad] = useState('')
    const [invitado, setInvitado] = useState(false)
    
    // db error array

    const [errors, setErrors] = useState([]);


    const createAttendee = (e) => {
        e.preventDefault();

        const newUser = { nombre, apellido, iglesia, edad, invitado };

        axios.post('http://localhost:8000/api/attendees', newUser)
            .then(res => {
                console.log(" client sucess")
                console.log(res.data)
                navigate('/home')
            })
            .catch(err => {
                console.log(' client error ')
                console.log(err)
                const errorResponse = err.response.data.errors;
                const  errorArr = [];
                for (const key of Object.keys(errorResponse)){
                    errorArr.push(errorResponse[key].message)
                }
                setErrors(errorArr);
            })

    }


    return (
        <div className="mainContainer">
            <div>
                <Link to="/home">
                    <svg xmlns="http://www.w3.org/2000/svg" style={{ width: "24px", height: "24px", padding:"25px" }} viewBox="0 0 448 512">
                        <path fill="#000000" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z" />
                    </svg>
                </Link>
            </div>
            <div style={{display:" flex",  justifyContent:"center",flexDirection:"column"}}>
            <div className="titleContainer">
                <div>
                    <h3>Mission palabra de vida</h3>
                </div>
                <div style={{textAlign:"center"}}>
                    <img src={Logo} alt="" style={{ width: "50px", height: "50px" }} />
                </div>
                
            </div>
            <svg width="90" height="19" viewBox="0 0 90 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6.44238 18.3C4.49238 18.3 3.00072 17.8083 1.96738 16.825C0.950716 15.8417 0.442383 14.45 0.442383 12.65V6.975C0.442383 5.175 0.95905 3.78333 1.99238 2.8C3.02572 1.81667 4.51738 1.325 6.46738 1.325C7.73405 1.325 8.83405 1.54167 9.76738 1.975C10.7007 2.39167 11.4007 3 11.8674 3.8C12.334 4.6 12.509 5.56667 12.3924 6.7C12.3757 6.75 12.3507 6.8 12.3174 6.85C12.3007 6.9 12.259 6.925 12.1924 6.925H11.2174C11.0841 6.925 11.034 6.86667 11.0674 6.75C11.1507 5.38333 10.7757 4.34167 9.94238 3.625C9.12572 2.89167 7.97572 2.525 6.49238 2.525C4.97572 2.525 3.80905 2.90833 2.99238 3.675C2.17572 4.44167 1.76738 5.54167 1.76738 6.975V12.65C1.76738 14.0833 2.17572 15.1833 2.99238 15.95C3.80905 16.7167 4.97572 17.1 6.49238 17.1C8.00905 17.1 9.16738 16.7417 9.96738 16.025C10.7674 15.3083 11.134 14.2583 11.0674 12.875C11.034 12.7583 11.0841 12.7 11.2174 12.7H12.1924C12.2924 12.7 12.3591 12.775 12.3924 12.925C12.4591 14.0417 12.2591 15 11.7924 15.8C11.3257 16.6 10.6341 17.2167 9.71738 17.65C8.81738 18.0833 7.72572 18.3 6.44238 18.3ZM24.9127 18C24.8127 18 24.7627 17.9417 24.7627 17.825V9.825C24.7627 8.79167 24.5544 8.03333 24.1377 7.55C23.7377 7.05 23.121 6.8 22.2877 6.8C21.471 6.8 20.671 7.05 19.8877 7.55C19.1044 8.03333 18.2877 8.74167 17.4377 9.675L17.4627 8.375C18.0294 7.75833 18.5877 7.25 19.1377 6.85C19.6877 6.43333 20.246 6.125 20.8127 5.925C21.3794 5.725 21.9627 5.625 22.5627 5.625C23.7127 5.625 24.5877 5.95833 25.1877 6.625C25.7877 7.29167 26.0877 8.33333 26.0877 9.75V17.825C26.0877 17.9417 26.0294 18 25.9127 18H24.9127ZM16.5377 18C16.421 18 16.3627 17.9417 16.3627 17.825V1.1C16.3627 0.983332 16.421 0.924999 16.5377 0.924999H17.5377C17.6377 0.924999 17.6877 0.983332 17.6877 1.1V17.825C17.6877 17.9417 17.6377 18 17.5377 18H16.5377ZM34.6787 18.3C33.112 18.3 31.9204 17.925 31.1037 17.175C30.287 16.425 29.8787 15.325 29.8787 13.875V10.35C29.8787 8.8 30.2787 7.625 31.0787 6.825C31.8787 6.025 33.0537 5.625 34.6037 5.625C36.1704 5.625 37.3454 6.025 38.1287 6.825C38.9287 7.60833 39.3287 8.76667 39.3287 10.3V11.975C39.3287 12.075 39.2787 12.125 39.1787 12.125H31.2037V13.525C31.2037 14.7417 31.487 15.6417 32.0537 16.225C32.637 16.8083 33.5287 17.1 34.7287 17.1C35.712 17.1 36.462 16.9167 36.9787 16.55C37.4954 16.1667 37.7537 15.6333 37.7537 14.95C37.7537 14.8333 37.8204 14.775 37.9537 14.775H38.9287C39.0287 14.775 39.087 14.825 39.1037 14.925C39.137 15.975 38.762 16.8 37.9787 17.4C37.212 18 36.112 18.3 34.6787 18.3ZM31.2037 10.975H38.0037V10.425C38.0037 9.20833 37.7204 8.3 37.1537 7.7C36.587 7.1 35.7454 6.8 34.6287 6.8C33.4787 6.8 32.6204 7.10833 32.0537 7.725C31.487 8.325 31.2037 9.225 31.2037 10.425V10.975ZM47.5217 18.3C45.9383 18.3 44.73 17.9083 43.8967 17.125C43.08 16.325 42.6717 15.175 42.6717 13.675V10.35C42.6717 8.81667 43.08 7.65 43.8967 6.85C44.73 6.03333 45.93 5.625 47.4967 5.625C48.4467 5.625 49.255 5.775 49.9217 6.075C50.605 6.35833 51.13 6.76667 51.4967 7.3C51.8633 7.81667 52.0467 8.44167 52.0467 9.175C52.0467 9.39167 51.9883 9.5 51.8717 9.5H50.8717C50.8383 9.5 50.805 9.48333 50.7717 9.45C50.7383 9.4 50.7217 9.33333 50.7217 9.25C50.7217 8.48333 50.43 7.88333 49.8467 7.45C49.28 7.01667 48.4967 6.8 47.4967 6.8C46.33 6.8 45.455 7.10833 44.8717 7.725C44.2883 8.325 43.9967 9.24167 43.9967 10.475V13.55C43.9967 14.7333 44.2883 15.625 44.8717 16.225C45.4717 16.8083 46.3633 17.1 47.5467 17.1C48.5633 17.1 49.3467 16.875 49.8967 16.425C50.4467 15.975 50.7217 15.3583 50.7217 14.575C50.7217 14.4083 50.7717 14.325 50.8717 14.325H51.8717C51.9883 14.325 52.0467 14.375 52.0467 14.475C52.0467 15.675 51.6633 16.6167 50.8967 17.3C50.1467 17.9667 49.0217 18.3 47.5217 18.3ZM55.9664 18C55.8497 18 55.7914 17.9417 55.7914 17.825V1.1C55.7914 0.983332 55.8497 0.924999 55.9664 0.924999H56.9664C57.0664 0.924999 57.1164 0.983332 57.1164 1.1V8.575C57.1164 8.975 57.1164 9.375 57.1164 9.775C57.1164 10.1583 57.1164 10.55 57.1164 10.95C57.1164 11.3333 57.1164 11.725 57.1164 12.125H57.1414C57.4747 11.775 57.7997 11.425 58.1164 11.075C58.4497 10.725 58.7914 10.3833 59.1414 10.05L63.0164 6C63.0664 5.95 63.1414 5.925 63.2414 5.925H64.5914C64.6581 5.925 64.6997 5.94167 64.7164 5.975C64.7497 6.00833 64.7331 6.05833 64.6664 6.125L60.3164 10.525L65.1914 17.8C65.2247 17.85 65.2247 17.9 65.1914 17.95C65.1747 17.9833 65.1331 18 65.0664 18H63.8914C63.8081 18 63.7414 17.9583 63.6914 17.875L59.3664 11.5L57.1164 13.775V17.825C57.1164 17.9417 57.0664 18 56.9664 18H55.9664ZM74.1119 18C73.9952 18 73.9369 17.9417 73.9369 17.825V1.8C73.9369 1.68333 73.9952 1.625 74.1119 1.625H75.1119C75.2119 1.625 75.2619 1.68333 75.2619 1.8V17.825C75.2619 17.9417 75.2119 18 75.1119 18H74.1119ZM88.2916 18C88.1916 18 88.1416 17.9417 88.1416 17.825V9.825C88.1416 8.79167 87.9333 8.03333 87.5166 7.55C87.1166 7.05 86.4916 6.8 85.6416 6.8C84.8416 6.8 84.0583 7.04167 83.2916 7.525C82.5416 8.00833 81.7083 8.725 80.7916 9.675V8.4C81.3749 7.76667 81.9416 7.25 82.4916 6.85C83.0583 6.43333 83.6166 6.125 84.1666 5.925C84.7333 5.725 85.3166 5.625 85.9166 5.625C87.0666 5.625 87.9416 5.95833 88.5416 6.625C89.1583 7.29167 89.4666 8.33333 89.4666 9.75V17.825C89.4666 17.9417 89.4083 18 89.2916 18H88.2916ZM79.9166 18C79.7999 18 79.7416 17.9417 79.7416 17.825V8.825C79.7416 8.39167 79.7249 7.925 79.6916 7.425C79.6583 6.925 79.6249 6.49167 79.5916 6.125C79.5749 5.99167 79.6333 5.925 79.7666 5.925H80.6916C80.7583 5.925 80.7999 5.93333 80.8166 5.95C80.8499 5.96667 80.8749 6.00833 80.8916 6.075C80.9249 6.29167 80.9499 6.54167 80.9666 6.825C80.9999 7.10833 81.0249 7.40833 81.0416 7.725C81.0583 8.025 81.0666 8.3 81.0666 8.55V9V17.825C81.0666 17.9417 81.0166 18 80.9166 18H79.9166Z" fill="#0F0E0E" />
                </svg>
            </div>
            <form onSubmit={createAttendee}>
                {errors.map((err, index) => <p key={index}> {err}</p>)}
                <div className="formContainer" >
                    <div className="container1">
                        <div>
                            <label htmlFor="">Nombre</label>
                            <input type="text" onChange={e => setNombre(e.target.value)} value={nombre} placeholder="Nombre" />
                        </div>
                        <div>
                            <label htmlFor="">Apellido</label>
                            <input type="text" onChange={e => setApellido(e.target.value)} value={apellido} placeholder="Apellido" />
                        </div>
                    </div>

                    <div className="container2">
                        <div>
                            <label htmlFor="">Iglesia</label>
                            <select id="iglesia" onChange={(e) => setIglesia(e.target.value)} value={iglesia} required>
                                <option value="Santo Domingo">Santo Domingo</option>
                                <option value="La Canela">La Canela</option>
                                <option value="New Jersey">New Jersey</option>
                            </select>
                        </div>
                        <div>
                            <label htmlFor="">Edad</label>
                            <input type="number" onChange={e => setEdad(e.target.value)} value={edad} placeholder="Edad" style={{ "-webkit-appearance": "none", "-moz-appearance": "textfield" }} />
                        </div>
                    </div>
                    <div>
                    <div className="checkboxInput">
                        <input type="checkbox" onChange={e => setInvitado(e.target.checked)} checked={invitado} />
                        <label htmlFor="">Invitado?</label>
                    </div>
                    <p style={{ color: "rgba(117, 117, 117, 1)", fontSize: "14px", paddingLeft: "1vh" }}>Si usted ha sido invitado/a, por favor marque esta casilla.</p>
                    </div>
                </div>
                <div className="buttonContainer">
                <button id="RegistrationBtn">Registrarse</button>
                </div>
                {/* <button id="RegistrationBtn">Registrarse</button> */}
            </form>
            
        </div>
    );
};

export default RegForm;
